# service-for-user-segmentation
Microservice for managing user segments and experiment distribution
Микросервис для создания сегментов и управления ими, с возможностью распределения сегментов по пользователям.
Алгоритм запуска проекта:
1. Установите зависимости из requirements:
```bash
pip install -r requirements.txt
```
2. Инициализируйте БД (автоматически создает файл `user_segments.db`):
```bash
python database.py
```
3. Запустите сервер:
```bash
python app.py
```
API Эндпоинты:
- `POST /segments/` - Создать сегмент
- `DELETE /segments/{slug}` - Удалить сегмент
- `POST /users/{user_id}/segments` - Обновить сегменты пользователя
- `GET /users/{user_id}/segments` - Получить сегменты пользователя
- `POST /segments/{slug}/distribute` - Распределить сегмент на % пользователей

Для получения документации API:
После запуска сервера откройте в браузере:  
http://localhost:8000/docs

Для автоматической проверки основных функций API:
1. Запустите сервер:
```bash
python app.py
```
2. Запустите test_api.py во втором терминале:
``` bash
python test_api.py
```
Автоматически тестируются такие функкции как: cоздание сегмента(включая попытку создания дубликата), удаление сегмента, добавление сегментов пользователю, получение сегментов пользователя, удаление одного сегмента, создание сегмента для распределения, распределение на 30% пользователей и другие функции и ошибки.
